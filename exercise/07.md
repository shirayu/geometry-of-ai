# 第7回：不確実性の復権

## 問題 7-1 ★ 点埋め込みと分布埋め込み

「点埋め込み」と「分布埋め込み（vMF）」の違いを、ハルシネーション検出の観点から説明せよ。

**ヒント:** 「分かりません」と言えるかどうか。

**解答:**
**点埋め込み:**

- 各入力は高次元空間の1点にマッピング
- 「この点がどれだけ信頼できるか」の情報がない
- 未知の入力も、既知の入力と同じように1点で表現される
- → ハルシネーション検出が困難

**分布埋め込み（vMF）:**

- 各入力は球面上の分布（平均方向 $\mu$ と集中度 $\kappa$ ）にマッピング
- $\kappa$ が小さい = 「この方向は不確か」
- 適切に学習させれば、未知の入力は $\kappa$ が小さくなりやすい（どの方向にも確信がない）
- → 低 $\kappa$ を閾値として「分かりません」と言える

**ハルシネーション対策:** 出力前に $\kappa$ をチェックし、閾値以下なら回答を控える。点埋め込みではこの「ブレーキ」が実装しにくい。

**注意:** 「未知入力で $\kappa$ が小さくなる」性質は、不確実性を校正する損失関数やOOD（分布外）データの扱いなど、学習設計に依存する。素朴な学習では自動的には保証されない。

## 問題 7-2 ★★ 埋め込み空間の比較

2つの埋め込み空間を比較する際、「回転合わせ（Procrustes）」が必要になる場合と、不要な場合を説明せよ。

**ヒント:** 回転不変な量とは何か？

**解答:**
**回転合わせが必要な場合:**

- 2つの埋め込み空間で、同じ概念が異なる方向を向いている
- 例：言語Aの埋め込みと言語Bの埋め込みを比較する場合
- 「犬」がどちらの空間でも同じ相対的位置関係を持っていても、絶対的な方向は異なる
- Procrustes分析で最適な回転行列を求め、空間を整列させる必要がある

**回転合わせが不要な場合:**

- 比較に使う量が回転不変である場合
- 例：
    - 点間の角度（内積/cosine類似度）
    - vMFの $\kappa$ （集中度）
    - 分布のエントロピー
- これらは座標系の取り方に依存しないため、回転合わせなしで比較可能

**実用的意義:** 回転不変な指標を使えば、異なるモデル・異なる学習ランの埋め込みを直接比較できる。
