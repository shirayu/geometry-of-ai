# 第0回：幾何学という言語

## 問題 0-1 ★ 球面上の測地線

地球上の2点、東京（北緯35.7度、東経139.7度）とニューヨーク（北緯40.7度、西経74.0度）を結ぶ最短経路は、地図上では曲線に見える。なぜ「直線」ではないのか、多様体の言葉で説明せよ。

**ヒント:** 「直線」と「測地線」の違いを考えよ。地球は何多様体か？

**解答:**
地球は球面（2次元多様体）であり、その上での「最短経路」は測地線、すなわち大円の一部である。平面地図は球面をユークリッド平面に射影したものであり、この射影によって測地線（大円）は一般に曲線として描かれる。

「直線」はユークリッド空間での測地線に過ぎない。多様体上では、測地線が「直線の一般化」であり、空間の曲率によってその形状が決まる。地球の正の曲率が、測地線を大円にする。

## 問題 0-2 ★★ フィッシャー情報行列とリーマン計量

フィッシャー情報行列が「確率分布空間のリーマン計量」であるとはどういう意味か。直感的に説明せよ。

**ヒント:** リーマン計量は「距離の測り方」を定める。パラメータを少し動かしたとき、分布がどれだけ「変わった」と感じるか？

**解答:**
リーマン計量は、多様体上の各点で「微小な移動の長さ」を測る装置である。確率分布の空間を多様体と見たとき、フィッシャー情報行列は「パラメータを微小量 $d\theta$ だけ動かしたとき、分布がどれだけ変化するか」を測る。

具体的には、パラメータ $\theta$ の方向に動かしたとき、対数尤度の変化の分散（＝フィッシャー情報）が大きいほど、その方向への「距離」が大きいと感じる。これは「分布を区別しやすい方向は遠い」という直感に対応する。

この計量を使うと、KLダイバージェンスの2次近似がフィッシャー計量による距離の2乗になるなど、情報理論と幾何学が自然に結びつく。

## 問題 0-3 ★★★ 連続と離散の界面

本講義は「連続多様体」を主役にするが、LLMの出力は「離散トークン」である。この「界面」が問題になる具体的な場面を一つ挙げ、なぜ問題なのか説明せよ。

**ヒント:** 学習時と推論時で何が違うか？　微分可能性は？

**解答:**
**具体例:** 強化学習からのフィードバック（RLHF）における報酬の勾配伝播。

**問題の説明:**
LLMの学習では、連続的なlogit空間で勾配降下を行う。しかしRLHFでは、実際に生成された離散トークン列に対して報酬が与えられる。argmaxやサンプリングによる離散化は微分不可能であり、報酬から重みへの勾配が直接流れない。

これを回避するために、policy gradient（REINFORCEなど）やPPOが使われるが、分散が大きく学習が不安定になりやすい。連続空間での美しい最適化理論と、離散出力の現実との間にギャップがある。
