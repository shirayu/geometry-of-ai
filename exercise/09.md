# 第9回：拡散と凝縮

## 問題 9-1 ★ 拡散モデルの収束

拡散モデルのforward processで、ステップ数を増やすと最終状態がガウス分布に近づく理由を、直感的に説明せよ。

**ヒント:** 各ステップの操作（線形変換＋ガウスノイズ）に注目せよ。

**解答:**
**Forward process:**
各ステップで、現在の状態に少量のガウスノイズを加える：
$x_{t+1} = \sqrt{1-\beta_t} x_t + \sqrt{\beta_t} \epsilon_t, \epsilon_t \sim N(0, I)$

**なぜガウスに収束するか:**

1. 各ステップは「線形変換＋ガウスノイズ」であり、ガウス分布に対してガウス性を保つ
2. 元の信号成分は $\sqrt{1-\beta_t}$ の係数で指数的に減衰していく
3. 一方、ノイズ成分は蓄積し続ける
4. 十分なステップ後、元の信号の寄与はほぼゼロになり、ノイズが支配的になる
5. 結果として、初期分布に依らず標準ガウス $N(0, I)$ に収束する

**直感:** 「インクを水に垂らすと拡散する」。十分な時間が経てば、インクの初期形状に関係なく、均一に広がる。信号が減衰し、ノイズが支配するという構造が、この収束を保証している。

## 問題 9-2 ★★ DDPMとDDIMの違い

DDPMとDDIMの違いを、「確率的 vs 決定論的」の観点から説明せよ。

**ヒント:** 同じノイズ画像から生成を始めたとき、毎回同じ画像が生成されるか？

**解答:**
**DDPM（Denoising Diffusion Probabilistic Models）:**

- Reverse processは確率的（各ステップでノイズをサンプリング）
- 同じ初期ノイズから始めても、毎回異なる画像が生成される
- SDEの逆過程に対応

**DDIM（Denoising Diffusion Implicit Models）:**

- Reverse processを決定論的に再定式化
- 同じ初期ノイズからは常に同じ画像が生成される
- ODEの解軌道に対応
- ステップ数を大幅に削減可能（1000→50など）

**幾何学的解釈:**

- DDPM：多様体上のブラウン運動の逆再生（確率的軌跡）
- DDIM：多様体上の決定論的フロー（一意の軌跡）

**実用上の違い:**

- 多様性が欲しい → DDPM
- 再現性・高速化が欲しい → DDIM
