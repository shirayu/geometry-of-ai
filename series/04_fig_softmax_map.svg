<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   viewBox="0 0 680 380"
   font-family="'STIX Two Math', 'Latin Modern Math', 'Cambria Math', serif"
   version="1.1"
   id="svg33"
   sodipodi:docname="04_fig_softmax_map.svg"
   inkscape:version="1.4.2 (ebf0e940d0, 2025-05-08)"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg">
  <sodipodi:namedview
     id="namedview33"
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1.0"
     inkscape:showpageshadow="2"
     inkscape:pageopacity="0.0"
     inkscape:pagecheckerboard="0"
     inkscape:deskcolor="#d1d1d1"
     inkscape:zoom="1.3611806"
     inkscape:cx="353.36973"
     inkscape:cy="144.72731"
     inkscape:window-width="2098"
     inkscape:window-height="1211"
     inkscape:window-x="0"
     inkscape:window-y="0"
     inkscape:window-maximized="0"
     inkscape:current-layer="svg33" />
  <defs
     id="defs3">
    <style
       id="style1">
      .label { font-size: 14px; fill: #1a1a2e; }
      .label-sm { font-size: 12px; fill: #555; }
      .label-math { font-size: 15px; fill: #1a1a2e; font-style: italic; }
      .title { font-size: 16px; fill: #1a1a2e; font-weight: 600; }
      .annotation { font-size: 11.5px; fill: #444; }
    </style>
    <marker
       id="arrowBlue"
       markerWidth="10"
       markerHeight="7"
       refX="9"
       refY="3.5"
       orient="auto">
      <polygon
         points="0 0, 10 3.5, 0 7"
         fill="#2c3e50"
         id="polygon1" />
    </marker>
    <marker
       id="arrowGray"
       markerWidth="8"
       markerHeight="6"
       refX="7"
       refY="3"
       orient="auto">
      <polygon
         points="0 0, 8 3, 0 6"
         fill="#888"
         id="polygon2" />
    </marker>
    <linearGradient
       id="logitBg"
       x1="0"
       y1="0"
       x2="0"
       y2="1">
      <stop
         offset="0%"
         stop-color="#f0f0f8"
         id="stop2" />
      <stop
         offset="100%"
         stop-color="#e2e2f0"
         id="stop3" />
    </linearGradient>
  </defs>
  <!-- Title -->
  <text
     x="340"
     y="28"
     text-anchor="middle"
     class="title"
     id="text3">Softmax写像：ℝᴷ → int(Δᴷ⁻¹)</text>
  <!-- ===== Left: Logit space R^K ===== -->
  <rect
     x="20"
     y="50"
     width="210"
     height="270"
     rx="8"
     fill="url(#logitBg)"
     stroke="#999"
     stroke-width="1.2"
     id="rect3" />
  <line
     x1="83.289871"
     y1="159.60182"
     x2="163.38547"
     y2="194.9696"
     stroke="#9b59b6"
     stroke-width="1.83641"
     stroke-dasharray="3, 2"
     opacity="0.6"
     id="line16" />
  <text
     x="125"
     y="75"
     text-anchor="middle"
     class="label"
     font-weight="600"
     id="text4">ロジット空間 ℝᴷ</text>
  <!-- Grid lines -->
  <g
     opacity="0.15"
     stroke="#666"
     stroke-width="0.5"
     id="g12">
    <line
       x1="40"
       y1="100"
       x2="40"
       y2="300"
       id="line4" />
    <line
       x1="80"
       y1="100"
       x2="80"
       y2="300"
       id="line5" />
    <line
       x1="120"
       y1="100"
       x2="120"
       y2="300"
       id="line6" />
    <line
       x1="160"
       y1="100"
       x2="160"
       y2="300"
       id="line7" />
    <line
       x1="200"
       y1="100"
       x2="200"
       y2="300"
       id="line8" />
    <line
       x1="40"
       y1="130"
       x2="210"
       y2="130"
       id="line9" />
    <line
       x1="40"
       y1="175"
       x2="210"
       y2="175"
       id="line10" />
    <line
       x1="40"
       y1="220"
       x2="210"
       y2="220"
       id="line11" />
    <line
       x1="40"
       y1="265"
       x2="210"
       y2="265"
       id="line12" />
  </g>
  <!-- Sample points in R^K -->
  <circle
     cx="70"
     cy="130"
     r="4.5"
     fill="#e67e22"
     id="circle12" />
  <text
     x="39.922077"
     y="116.57143"
     class="label-sm"
     fill="#e67e22"
     id="text12">z₁ = (5, 1, 0)</text>
  <circle
     cx="119.74026"
     cy="175.25974"
     r="4.5"
     fill="#e67e22"
     id="circle13" />
  <text
     x="92.117744"
     y="188.69174"
     class="label-sm"
     fill="#e67e22"
     id="text13"><tspan
       sodipodi:role="line"
       id="tspan35"
       x="92.117744"
       y="188.69174">z₂ = 𝟏</tspan><tspan
       sodipodi:role="line"
       id="tspan36"
       x="92.117744"
       y="203.69174"
       style="font-size:8px">= (1, 1, 1)</tspan></text>
  <circle
     cx="98.441559"
     cy="255.84416"
     r="4.5"
     fill="#e67e22"
     id="circle14" />
  <text
     x="69.402596"
     y="247.93506"
     class="label-sm"
     fill="#e67e22"
     id="text14">z₃ = (−2, 0, 3)</text>
  <!-- Points on 1-direction (same image) -->
  <circle
     cx="80.519478"
     cy="158.63637"
     r="3.5"
     fill="#9b59b6"
     opacity="0.7"
     id="circle15" />
  <circle
     cx="167.71429"
     cy="196.81819"
     r="3.5"
     fill="#9b59b6"
     opacity="0.7"
     id="circle16" />
  <text
     x="92.538864"
     y="152.00368"
     class="annotation"
     fill="#9b59b6"
     id="text16">z₂+ c₁·𝟏</text>
  <text
     x="162.49687"
     y="210.79639"
     class="annotation"
     fill="#9b59b6"
     id="text16-6"
     style="font-size:11.5px;fill:#444444">z₂ - c₂·𝟏</text>
  <text
     x="274.20776"
     y="208.44156"
     class="annotation"
     fill="#9b59b6"
     id="text17"><tspan
       sodipodi:role="line"
       id="tspan37"
       x="274.20776"
       y="208.44156">（𝟏方向に平行な点は</tspan><tspan
       sodipodi:role="line"
       id="tspan38"
       x="274.20776"
       y="223.73521">同一の分布に写る）</tspan></text>
  <!-- ===== Arrow: Softmax ===== -->
  <line
     x1="290"
     y1="141"
     x2="392"
     y2="141"
     stroke="#2c3e50"
     stroke-width="2.5"
     marker-end="url(#arrowBlue)"
     id="line18" />
  <text
     x="341"
     y="131"
     text-anchor="middle"
     class="label"
     font-weight="600"
     id="text19">Softmax</text>
  <text
     x="341"
     y="166"
     text-anchor="middle"
     class="annotation"
     id="text20">exp(zᵢ) / Σ exp(zⱼ)</text>
  <!-- ===== Right: Simplex ===== -->
  <!-- Triangle: A(520,60) top, B(390,305) bottom-left, C(650,305) bottom-right -->
  <g
     id="g30">
    <!-- Interior fill -->
    <polygon
       points="520,60 390,305 650,305"
       fill="#dceefb"
       opacity="0.5"
       id="polygon20" />
    <!-- Boundary (red) -->
    <polygon
       points="520,60 390,305 650,305"
       fill="none"
       stroke="#e74c3c"
       stroke-width="2.2"
       id="polygon21" />
    <!-- Dashed interior contour -->
    <polygon
       points="520,80 408,295 632,295"
       fill="none"
       stroke="#3498db"
       stroke-width="1.2"
       stroke-dasharray="5,3"
       id="polygon22" />
    <!-- Vertex labels -->
    <circle
       cx="520"
       cy="60"
       r="5"
       fill="#e74c3c"
       id="circle22" />
    <text
       x="540"
       y="58"
       class="label-sm"
       fill="#c0392b"
       id="text22">(1,0,0)</text>
    <circle
       cx="390"
       cy="305"
       r="5"
       fill="#e74c3c"
       id="circle23" />
    <text
       x="365"
       y="322"
       class="label-sm"
       fill="#c0392b"
       id="text23">(0,1,0)</text>
    <circle
       cx="650"
       cy="305"
       r="5"
       fill="#e74c3c"
       id="circle24" />
    <text
       x="638"
       y="322"
       class="label-sm"
       fill="#c0392b"
       id="text24">(0,0,1)</text>
    <!-- Interior label -->
    <text
       x="523.11688"
       y="137.98701"
       text-anchor="middle"
       class="label"
       fill="#2471a3"
       id="text25">int(Δ²)</text>
    <text
       x="522.07794"
       y="162.85715"
       text-anchor="middle"
       class="annotation"
       fill="#2471a3"
       id="text26">滑らかな多様体</text>
    <!-- Mapped point: z1 → near top vertex -->
    <circle
       cx="518"
       cy="92"
       r="4.5"
       fill="#e67e22"
       id="circle26" />
    <text
       x="546.83118"
       y="94.402596"
       class="annotation"
       fill="#e67e22"
       id="text27">(0.94, 0.02, 0.01)</text>
    <!-- Mapped point: z2 → center (uniform) -->
    <circle
       cx="520"
       cy="223"
       r="4.5"
       fill="#e67e22"
       id="circle27" />
    <!-- Purple ring: z+c·1 also maps here -->
    <circle
       cx="520"
       cy="223"
       r="8"
       fill="none"
       stroke="#9b59b6"
       stroke-width="1.2"
       stroke-dasharray="3,2"
       id="circle28" />
    <!-- Mapped point: z3 → near bottom-right vertex -->
    <circle
       cx="619.0415"
       cy="286.75543"
       r="4.5"
       fill="#e67e22"
       id="circle29" />
    <text
       x="528.56097"
       y="282.31754"
       class="annotation"
       fill="#e67e22"
       id="text29">(-.01, 0.05, 0.95)</text>
    <text
       x="488.32562"
       y="241.02992"
       class="annotation"
       fill="#e67e22"
       id="text29-5"
       style="font-size:11.5px;fill:#444444">(1/3, 1/3, 1/3)</text>
    <!-- Boundary annotation -->
    <text
       x="520"
       y="336"
       text-anchor="middle"
       class="annotation"
       fill="#c0392b"
       id="text30">境界：到達不可能（pᵢ &gt; 0 常に成立）</text>
  </g>
  <!-- Mapping arrows (gray, curved) -->
  <path
     d="M 74,130 C 200,80 380,60 515,90"
     fill="none"
     stroke="#bbb"
     stroke-width="1"
     stroke-dasharray="4,3"
     marker-end="url(#arrowGray)"
     id="path30" />
  <path
     d="m 131.73632,178.21096 c 130.07434,-15.85397 284.92476,23.78096 384.02902,42.80572"
     fill="none"
     stroke="#bbbbbb"
     stroke-width="1"
     stroke-dasharray="4, 3"
     marker-end="url(#arrowGray)"
     id="path31" />
  <path
     d="m 103.9735,257.96915 c 123.37235,26.71352 358.36732,44.52254 514.05149,30.27532"
     fill="none"
     stroke="#bbbbbb"
     stroke-width="0.943562"
     stroke-dasharray="4, 3"
     marker-end="url(#arrowGray)"
     id="path32" />
  <!-- Legend bar -->
  <rect
     x="370"
     y="350"
     width="295"
     height="22"
     rx="3"
     fill="#fafafa"
     stroke="#ccc"
     stroke-width="0.7"
     id="rect32" />
  <line
     x1="382"
     y1="361"
     x2="402"
     y2="361"
     stroke="#e74c3c"
     stroke-width="2"
     id="line32" />
  <text
     x="406"
     y="365"
     class="annotation"
     fill="#c0392b"
     id="text32">境界（特異）</text>
  <line
     x1="485"
     y1="361"
     x2="505"
     y2="361"
     stroke="#3498db"
     stroke-width="1.2"
     stroke-dasharray="5,3"
     id="line33" />
  <text
     x="509"
     y="365"
     class="annotation"
     fill="#2471a3"
     id="text33">開内部（像の範囲）</text>
</svg>
