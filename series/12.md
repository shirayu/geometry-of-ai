# 第12回：双曲幾何学 ～負の曲率の世界～

## 注意事項

- 双曲空間が有効なのは、データに階層的・木構造的な性質がある場合。
- すべてのデータが双曲空間に適しているわけではない（平坦・球面が適する場合も多い）。
- 「曲率の選択」はタスク依存であり、万能の幾何学はない。
- Mixed-curvature spacesは研究段階であり、標準手法ではない。

## トピック

球面を超えて

## 内容

- **階層構造の埋め込み問題:**
    - 木構造（系統樹、組織図、WordNet）をユークリッド/球面に埋め込むと歪む
    - 子ノードが増えると、親の周りに「収まらない」
    - これは空間の曲率が合っていないから
- **双曲空間 (Hyperbolic Space) の発見:**
    - **負の曲率** → 周囲長が指数関数的に増大
    - 馬の鞍のような形状（局所的に）
    - ユークリッド：周囲長 ∝ $r$
    - 球面：周囲長 ∝ $\sin(r)$ （有限）
    - 双曲：周囲長 ∝ $\sinh(r) \approx e^r$ （指数的）
- **ポアンカレ円板モデル:**
    - 単位円板内に無限の双曲空間を表現
    - 中心から離れるほど「実際の距離」は遠い
    - エッシャーの「円の極限」シリーズの数学的背景
- **階層構造の自然な埋め込み:**
    - 親ノード：中心付近
    - 子ノード：外側へ
    - 深さが増すほど「部屋」が広がる（指数的増加）
    - これは木構造の本質的な性質と一致
- **応用例:**
    - **WordNet 埋め込み:** "動物" → "哺乳類" → "犬" という階層
    - **知識グラフ:** エンティティ間の上下関係
    - **社会ネットワーク:** 影響力の階層構造
- **球面との対比:**

    | 空間 | 曲率 | 適したデータ | 例 |
    | --- | --- | --- | --- |
    | ユークリッド | 0 | 平坦な関係 | 一般的な埋め込み |
    | 球面 | 正 | 等価な関係 | 正規化類似・意味空間 |
    | 双曲 | 負 | 階層的関係 | 木構造、オントロジー |

- **測地線の違い（概念的）:**
    - 球面：大円（円弧）
    - 双曲：モデルにより見え方が変わる（円板内の曲線等）

## 拡張

曲率をタスクに応じて選ぶ、あるいは**学習する**時代へ

- **「平坦」も悪くない:**
    - 講義は「ユークリッド→球面→双曲」という発展を描くが、**すべてを単一の幾何学で記述する必要はない**
    - **Mixed-curvature spaces（複合曲率空間）:**
        - 一部の次元はユークリッド、一部は球面、一部は双曲…のように「混ぜる」
        - 例：「意味的類似性」は球面、「階層」は双曲、「時系列」はユークリッド
        - ※代表例は下の「最新動向（2024-2025年）」参照
    - **完全球面化の限界:**
        - 全層を球面に縛ると、タスクによっては表現力が制限される場合がある
        - 一部にユークリッド的自由度を残す方が良いケースもありうる
    - **適材適所の幾何学:**
        - 万能の幾何学はない
        - データの構造に合わせて選ぶ
        - あるいは曲率自体を学習可能にする（フロンティア）

## 実装ノート

- 双曲幾何学の最適化：Geoopt等の利用を検討
- `geoopt.manifolds.PoincareBall()` でPoincaré球モデル（例）

## Visualization Break IV

### デモ：Poincaré円板を動かす（5分）

- 簡単な木構造（3階層）をPoincaré円板に埋め込み
- インタラクティブに回転・ズーム
- 同じ木をユークリッド空間に埋め込んだ場合との比較
- 「なぜ双曲空間が自然なのか」を視覚的に理解
