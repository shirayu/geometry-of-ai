<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 540 500" font-family="'STIX Two Math', 'Latin Modern Math', 'Cambria Math', serif">
  <defs>
    <style>
      .label { font-size: 14px; fill: #1a1a2e; }
      .label-sm { font-size: 12px; fill: #555; }
      .label-math { font-size: 15px; fill: #1a1a2e; font-style: italic; }
      .title { font-size: 16px; fill: #1a1a2e; font-weight: 600; }
      .boundary-line { stroke: #e74c3c; stroke-width: 2.2; fill: none; }
      .interior-fill { fill: #dceefb; opacity: 0.55; }
      .interior-stroke { stroke: #3498db; stroke-width: 1.2; stroke-dasharray: 5,3; fill: none; }
      .annotation { font-size: 11.5px; fill: #444; }
      .legend-box { rx: 4; ry: 4; stroke: #ccc; stroke-width: 0.8; fill: #fafafa; }
    </style>
    <pattern id="intGrid" x="0" y="0" width="12" height="12" patternUnits="userSpaceOnUse">
      <path d="M 12 0 L 0 0 0 12" fill="none" stroke="#b8d4e8" stroke-width="0.3"/>
    </pattern>
  </defs>

  <!-- Title -->
  <text x="270" y="30" text-anchor="middle" class="title">確率単体 Δ² （K = 3）</text>

  <!-- Triangle: A(270,65) top, B(80,380) bottom-left, C(460,380) bottom-right -->
  <g transform="translate(0,15)">
    <!-- Interior fill -->
    <polygon points="270,65 80,380 460,380" class="interior-fill"/>
    <polygon points="270,65 80,380 460,380" fill="url(#intGrid)"/>

    <!-- Boundary (red) -->
    <polygon points="270,65 80,380 460,380" class="boundary-line"/>

    <!-- Dashed interior contour -->
    <polygon points="270,88 100,368 440,368" class="interior-stroke"/>

    <!-- Vertex A: (1,0,0) top -->
    <circle cx="270" cy="65" r="6" fill="#e74c3c"/>
    <text x="270" y="49" text-anchor="middle" class="label-math">p₁ = 1</text>
    <text x="300" y="60" class="label-sm">(1, 0, 0)</text>

    <!-- Vertex B: (0,1,0) bottom-left -->
    <circle cx="80" cy="380" r="6" fill="#e74c3c"/>
    <text x="72" y="405" text-anchor="middle" class="label-math">p₂ = 1</text>
    <text x="72" y="420" text-anchor="middle" class="label-sm">(0, 1, 0)</text>

    <!-- Vertex C: (0,0,1) bottom-right -->
    <circle cx="460" cy="380" r="6" fill="#e74c3c"/>
    <text x="460" y="405" text-anchor="middle" class="label-math">p₃ = 1</text>
    <text x="460" y="420" text-anchor="middle" class="label-sm">(0, 0, 1)</text>

    <!-- Center (uniform distribution) — label below -->
    <circle cx="270" cy="275" r="5.5" fill="#2ecc71"/>
    <line x1="270" y1="281" x2="270" y2="303" stroke="#1a7a45" stroke-width="0.8"/>
    <text x="270" y="317" text-anchor="middle" class="label" fill="#1a7a45">一様分布 (1/3, 1/3, 1/3)</text>
    <text x="270" y="333" text-anchor="middle" class="annotation" fill="#1a7a45">H = log 3（最大）</text>

    <!-- Softmax output point — upper-left, leader line to label outside triangle -->
    <circle cx="205" cy="185" r="4.5" fill="#3498db"/>
    <line x1="205" y1="185" x2="155" y2="168" stroke="#2471a3" stroke-width="0.8" stroke-dasharray="3,2"/>
    <text x="70" y="163" class="label" fill="#2471a3">Softmax出力</text>
    <text x="70" y="178" class="label-sm" fill="#2471a3">（常に内部に留まる）</text>

    <!-- Sample point near boundary — bottom-left area -->
    <circle cx="155" cy="345" r="4" fill="#3498db" opacity="0.6"/>
    <line x1="155" y1="345" x2="105" y2="348" stroke="#3498db" stroke-width="0.8" stroke-dasharray="3,2"/>
    <text x="18" y="342" class="annotation" fill="#2471a3">p₂ ≈ 0.85</text>
    <text x="18" y="356" class="annotation" fill="#2471a3">（境界に近いが</text>
    <text x="18" y="370" class="annotation" fill="#2471a3">　到達しない）</text>

    <!-- Boundary labels -->
    <!-- Edge A–B (left) -->
    <text x="152" y="212" text-anchor="middle" transform="rotate(-59,152,212)" class="annotation" fill="#c0392b">境界：p₃ = 0</text>
    <!-- Edge B–C (bottom) -->
    <text x="270" y="398" text-anchor="middle" class="annotation" fill="#c0392b">境界：p₁ = 0</text>
    <!-- Edge A–C (right) -->
    <text x="388" y="212" text-anchor="middle" transform="rotate(59,388,212)" class="annotation" fill="#c0392b">境界：p₂ = 0</text>

    <!-- Interior label — right-lower area -->
    <text x="345" y="345" class="label" fill="#2471a3" opacity="0.7">int(Δ²)</text>
    <text x="335" y="361" class="annotation" fill="#2471a3" opacity="0.7">滑らかな多様体</text>
  </g>

  <!-- Legend -->
  <rect x="15" y="455" width="510" height="36" class="legend-box"/>
  <circle cx="35" cy="473" r="5" fill="#e74c3c"/>
  <text x="45" y="477" class="annotation">頂点・境界（特異、H = 0）</text>
  <line x1="180" y1="473" x2="200" y2="473" stroke="#3498db" stroke-width="1.5" stroke-dasharray="5,3"/>
  <text x="205" y="477" class="annotation">開内部（滑らかな多様体）</text>
  <circle cx="365" cy="473" r="5" fill="#2ecc71"/>
  <text x="375" y="477" class="annotation">中心（一様分布、H = log K）</text>
</svg>
